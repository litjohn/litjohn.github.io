<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>为你的设备配置更好的 DNS | 正确即是废话，废话亦是正确</title><meta name=keywords content><meta name=description content="前言
昨天对我的博客界面进行了更新。但是你可能发现数学公式（katex）炸了。
更有趣的是，你可能会发现换了一台设备，katex 又复活了。而在某些设备上，katex 就是渲染不出来。
这正是我本人的经历：我在家里能够看到正常渲染的 katex，但是到了学校就渲染不了。
事实上，这并不是我配置写出锅了。而是 GFW 搞的鬼。
排查问题
我们将使用一些入门级的网络开发者工具。
使用 F12 等方法打开 chrome（或其他浏览器）的开发者工具。选择“network”项。先点击左上角的灰色禁止图标（一个被斜杠穿过的圆圈）清除过去的活动记录，然后点击它左边的灰色同心圆开启活动记录录制（如果这个图标是红色的圆圈套着方框，那么录制已经开始了，不用管。这个图标看上去和你手机录像时的那个红色源泉很像）。勾选最上方的“preserve log”（其实不勾也行）。然后如果下面有一个类似于“/get”之类的过滤选项，关掉它。
访问我的博客。
看下面的那一栏（上面一栏是时间轴，不用理会），它显示了访问我博客时的各种网络活动，包括名字，URL，状态等等。
我们发现大多数都正常返回（状态码 200），但是有一些会显示叉和 404 或者其他一些状态码。这些请求里有名字带 .ico 或者类似于 icon 之类的，这些是请求博客的图标（我没设置），不用管。
注意到有名字中带 katex 和 css/js 或者 auto-render 之类的（比如 katex.min.js/katex.min.css/auto-render.min.js）。这些其实就是在向 cdn 请求用于渲染 katex 公式的脚本和样式。
观察到域名大概是 cdn.jsdelivr.net。
试着使用 curl/iwr 或者浏览器直接访问。发现访问不了。
至此，我们找到了罪魁祸首。
分析原因
jsdelivr 是一个著名的 cdn，可以让你把你的 git 仓库弄上去，然后提供加速的下载（即内容分发）。不过这个 cdn 现在不是很稳定，有时（指有些 DNS 服务器上）会被 DNS 污染导致访问不了。
事实上，这应该是 hugo 生成器或者 papermod 主题默认的 katex 来源。所以使用这套东西的人可能会遇到和我一模一样的问题。
所幸它没有遭遇 SNI 阻断甚至 IP 黑洞之类更加强力的 GFW 手段，这使得我们可以在直连情况下解决问题。"><meta name=author content><link rel=canonical href=https://litjohn.github.io/posts/use-better-dns/><link crossorigin=anonymous href=/assets/css/stylesheet.1fccae46ae9915f85f681da64c88b7bcb057c57a3f5200705675aedb46bd453d.css integrity="sha256-H8yuRq6ZFfhfaB2mTIi3vLBXxXo/UgBwVnWu20a9RT0=" rel="preload stylesheet" as=style><link rel=icon href=https://litjohn.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://litjohn.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://litjohn.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://litjohn.github.io/apple-touch-icon.png><link rel=mask-icon href=https://litjohn.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://litjohn.github.io/posts/use-better-dns/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.2/dist/katex.min.css integrity=sha384-bYdxxUwYipFNohQlHt0bjN/LCpueqWz13HufFEV1SUatKs1cm4L6fFgCi1jT643X crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.2/dist/katex.min.js integrity=sha384-Qsn9KnoKISj6dI8g7p1HBlNpVx0I8p1SvlwOldgi3IorMle61nQy4zEahWYtljaz crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.2/dist/contrib/auto-render.min.js integrity=sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05 crossorigin=anonymous></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],throwOnError:!1})})</script><meta property="og:url" content="https://litjohn.github.io/posts/use-better-dns/"><meta property="og:site_name" content="正确即是废话，废话亦是正确"><meta property="og:title" content="为你的设备配置更好的 DNS"><meta property="og:description" content="前言 昨天对我的博客界面进行了更新。但是你可能发现数学公式（katex）炸了。
更有趣的是，你可能会发现换了一台设备，katex 又复活了。而在某些设备上，katex 就是渲染不出来。
这正是我本人的经历：我在家里能够看到正常渲染的 katex，但是到了学校就渲染不了。
事实上，这并不是我配置写出锅了。而是 GFW 搞的鬼。
排查问题 我们将使用一些入门级的网络开发者工具。
使用 F12 等方法打开 chrome（或其他浏览器）的开发者工具。选择“network”项。先点击左上角的灰色禁止图标（一个被斜杠穿过的圆圈）清除过去的活动记录，然后点击它左边的灰色同心圆开启活动记录录制（如果这个图标是红色的圆圈套着方框，那么录制已经开始了，不用管。这个图标看上去和你手机录像时的那个红色源泉很像）。勾选最上方的“preserve log”（其实不勾也行）。然后如果下面有一个类似于“/get”之类的过滤选项，关掉它。
访问我的博客。
看下面的那一栏（上面一栏是时间轴，不用理会），它显示了访问我博客时的各种网络活动，包括名字，URL，状态等等。
我们发现大多数都正常返回（状态码 200），但是有一些会显示叉和 404 或者其他一些状态码。这些请求里有名字带 .ico 或者类似于 icon 之类的，这些是请求博客的图标（我没设置），不用管。
注意到有名字中带 katex 和 css/js 或者 auto-render 之类的（比如 katex.min.js/katex.min.css/auto-render.min.js）。这些其实就是在向 cdn 请求用于渲染 katex 公式的脚本和样式。
观察到域名大概是 cdn.jsdelivr.net。
试着使用 curl/iwr 或者浏览器直接访问。发现访问不了。
至此，我们找到了罪魁祸首。
分析原因 jsdelivr 是一个著名的 cdn，可以让你把你的 git 仓库弄上去，然后提供加速的下载（即内容分发）。不过这个 cdn 现在不是很稳定，有时（指有些 DNS 服务器上）会被 DNS 污染导致访问不了。
事实上，这应该是 hugo 生成器或者 papermod 主题默认的 katex 来源。所以使用这套东西的人可能会遇到和我一模一样的问题。
所幸它没有遭遇 SNI 阻断甚至 IP 黑洞之类更加强力的 GFW 手段，这使得我们可以在直连情况下解决问题。"><meta property="og:locale" content="zh-cn"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-11-26T18:38:39+08:00"><meta property="article:modified_time" content="2025-11-26T18:38:39+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="为你的设备配置更好的 DNS"><meta name=twitter:description content="前言
昨天对我的博客界面进行了更新。但是你可能发现数学公式（katex）炸了。
更有趣的是，你可能会发现换了一台设备，katex 又复活了。而在某些设备上，katex 就是渲染不出来。
这正是我本人的经历：我在家里能够看到正常渲染的 katex，但是到了学校就渲染不了。
事实上，这并不是我配置写出锅了。而是 GFW 搞的鬼。
排查问题
我们将使用一些入门级的网络开发者工具。
使用 F12 等方法打开 chrome（或其他浏览器）的开发者工具。选择“network”项。先点击左上角的灰色禁止图标（一个被斜杠穿过的圆圈）清除过去的活动记录，然后点击它左边的灰色同心圆开启活动记录录制（如果这个图标是红色的圆圈套着方框，那么录制已经开始了，不用管。这个图标看上去和你手机录像时的那个红色源泉很像）。勾选最上方的“preserve log”（其实不勾也行）。然后如果下面有一个类似于“/get”之类的过滤选项，关掉它。
访问我的博客。
看下面的那一栏（上面一栏是时间轴，不用理会），它显示了访问我博客时的各种网络活动，包括名字，URL，状态等等。
我们发现大多数都正常返回（状态码 200），但是有一些会显示叉和 404 或者其他一些状态码。这些请求里有名字带 .ico 或者类似于 icon 之类的，这些是请求博客的图标（我没设置），不用管。
注意到有名字中带 katex 和 css/js 或者 auto-render 之类的（比如 katex.min.js/katex.min.css/auto-render.min.js）。这些其实就是在向 cdn 请求用于渲染 katex 公式的脚本和样式。
观察到域名大概是 cdn.jsdelivr.net。
试着使用 curl/iwr 或者浏览器直接访问。发现访问不了。
至此，我们找到了罪魁祸首。
分析原因
jsdelivr 是一个著名的 cdn，可以让你把你的 git 仓库弄上去，然后提供加速的下载（即内容分发）。不过这个 cdn 现在不是很稳定，有时（指有些 DNS 服务器上）会被 DNS 污染导致访问不了。
事实上，这应该是 hugo 生成器或者 papermod 主题默认的 katex 来源。所以使用这套东西的人可能会遇到和我一模一样的问题。
所幸它没有遭遇 SNI 阻断甚至 IP 黑洞之类更加强力的 GFW 手段，这使得我们可以在直连情况下解决问题。"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://litjohn.github.io/posts/"},{"@type":"ListItem","position":2,"name":"为你的设备配置更好的 DNS","item":"https://litjohn.github.io/posts/use-better-dns/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"为你的设备配置更好的 DNS","name":"为你的设备配置更好的 DNS","description":"前言 昨天对我的博客界面进行了更新。但是你可能发现数学公式（katex）炸了。\n更有趣的是，你可能会发现换了一台设备，katex 又复活了。而在某些设备上，katex 就是渲染不出来。\n这正是我本人的经历：我在家里能够看到正常渲染的 katex，但是到了学校就渲染不了。\n事实上，这并不是我配置写出锅了。而是 GFW 搞的鬼。\n排查问题 我们将使用一些入门级的网络开发者工具。\n使用 F12 等方法打开 chrome（或其他浏览器）的开发者工具。选择“network”项。先点击左上角的灰色禁止图标（一个被斜杠穿过的圆圈）清除过去的活动记录，然后点击它左边的灰色同心圆开启活动记录录制（如果这个图标是红色的圆圈套着方框，那么录制已经开始了，不用管。这个图标看上去和你手机录像时的那个红色源泉很像）。勾选最上方的“preserve log”（其实不勾也行）。然后如果下面有一个类似于“/get”之类的过滤选项，关掉它。\n访问我的博客。\n看下面的那一栏（上面一栏是时间轴，不用理会），它显示了访问我博客时的各种网络活动，包括名字，URL，状态等等。\n我们发现大多数都正常返回（状态码 200），但是有一些会显示叉和 404 或者其他一些状态码。这些请求里有名字带 .ico 或者类似于 icon 之类的，这些是请求博客的图标（我没设置），不用管。\n注意到有名字中带 katex 和 css/js 或者 auto-render 之类的（比如 katex.min.js/katex.min.css/auto-render.min.js）。这些其实就是在向 cdn 请求用于渲染 katex 公式的脚本和样式。\n观察到域名大概是 cdn.jsdelivr.net。\n试着使用 curl/iwr 或者浏览器直接访问。发现访问不了。\n至此，我们找到了罪魁祸首。\n分析原因 jsdelivr 是一个著名的 cdn，可以让你把你的 git 仓库弄上去，然后提供加速的下载（即内容分发）。不过这个 cdn 现在不是很稳定，有时（指有些 DNS 服务器上）会被 DNS 污染导致访问不了。\n事实上，这应该是 hugo 生成器或者 papermod 主题默认的 katex 来源。所以使用这套东西的人可能会遇到和我一模一样的问题。\n所幸它没有遭遇 SNI 阻断甚至 IP 黑洞之类更加强力的 GFW 手段，这使得我们可以在直连情况下解决问题。\n","keywords":[],"articleBody":"前言 昨天对我的博客界面进行了更新。但是你可能发现数学公式（katex）炸了。\n更有趣的是，你可能会发现换了一台设备，katex 又复活了。而在某些设备上，katex 就是渲染不出来。\n这正是我本人的经历：我在家里能够看到正常渲染的 katex，但是到了学校就渲染不了。\n事实上，这并不是我配置写出锅了。而是 GFW 搞的鬼。\n排查问题 我们将使用一些入门级的网络开发者工具。\n使用 F12 等方法打开 chrome（或其他浏览器）的开发者工具。选择“network”项。先点击左上角的灰色禁止图标（一个被斜杠穿过的圆圈）清除过去的活动记录，然后点击它左边的灰色同心圆开启活动记录录制（如果这个图标是红色的圆圈套着方框，那么录制已经开始了，不用管。这个图标看上去和你手机录像时的那个红色源泉很像）。勾选最上方的“preserve log”（其实不勾也行）。然后如果下面有一个类似于“/get”之类的过滤选项，关掉它。\n访问我的博客。\n看下面的那一栏（上面一栏是时间轴，不用理会），它显示了访问我博客时的各种网络活动，包括名字，URL，状态等等。\n我们发现大多数都正常返回（状态码 200），但是有一些会显示叉和 404 或者其他一些状态码。这些请求里有名字带 .ico 或者类似于 icon 之类的，这些是请求博客的图标（我没设置），不用管。\n注意到有名字中带 katex 和 css/js 或者 auto-render 之类的（比如 katex.min.js/katex.min.css/auto-render.min.js）。这些其实就是在向 cdn 请求用于渲染 katex 公式的脚本和样式。\n观察到域名大概是 cdn.jsdelivr.net。\n试着使用 curl/iwr 或者浏览器直接访问。发现访问不了。\n至此，我们找到了罪魁祸首。\n分析原因 jsdelivr 是一个著名的 cdn，可以让你把你的 git 仓库弄上去，然后提供加速的下载（即内容分发）。不过这个 cdn 现在不是很稳定，有时（指有些 DNS 服务器上）会被 DNS 污染导致访问不了。\n事实上，这应该是 hugo 生成器或者 papermod 主题默认的 katex 来源。所以使用这套东西的人可能会遇到和我一模一样的问题。\n所幸它没有遭遇 SNI 阻断甚至 IP 黑洞之类更加强力的 GFW 手段，这使得我们可以在直连情况下解决问题。\n解决 第一步 首先我太懒不想改自己博客的配置。那么怎么办呢？不换 cdn，就要访问原来的 cdn。\n访问不了 cdn 是因为 DNS 污染。那么就从 DNS 污染上解决问题。\ncloudflare 提供了非常优质的 DNS 服务（服务器 IP 1.1.1.1 或 1.0.0.1）。我们配置它作为我们的 DNS 服务器直接就搞定了。\n具体而言，你可以搜索你的操作系统的具体方法。对于 Windows，打开设置项，进入“网络和 Internet \u003e 以太网”（当然也可以是 WLAN）然后你就能看到设置 DNS 服务器的选项，编辑一下，用 1.1.1.1 作为 IPv4 DNS 就完成了。\n不过这又引出了一些新的麻烦。\n解决与 clash 的冲突 如果你使用代理，你有概率发现你的代理用不成了。这非常的令人费解。你会发现你连不上代理服务器（也就是说不是 clash 等客户端的问题）\n怎么回事呢？\n很多代理的节点是用供应商自己的一个的中转服务器访问的，通过不同的端口控制你的流量转发到不同的海外节点。这个中转服务器有自己的域名，而不仅仅是通过 IP 访问。也就是说，你的 clash 要和这个服务器通信才能将你的流量转发到真正的代理节点上，而这个通信又需要解析域名。\n如果你用国内的 DNS，域名解析出来的 IP 是国内可直连的。但是 1.1.1.1 解析这个域名的策略和国内 DNS 不同，它可能会解析到中转服务器在海外的 IP。而这个 IP 是被墙掉的，你无法直连你的代理~~（你需要一个代理来访问你的代理）~~，这就导致你的代理用不成了。\n怎么办？怎么办？\n一种方法：编辑 hosts 文件，将你代理的中转服务器的域名绑定到可访问的 IP。或者编辑 clash 的配置文件中类似 hosts 的东西。\n但是这样会面临代理换用不同域名/IP 的问题。还有更好的办法。\n我们首先把 DNS 服务器改回来（比如改成 DHCP 自动分配）。然后我们敏锐的注意到一点：我们需要使用 1.1.1.1 解析的请求，大部分都是在浏览器端完成的。\n所以给浏览器设置一下，让它使用 1.1.1.1 作为 DNS 就行了。\n这无需额外插件，原生设置即可。对于 chrome，chrome://settings/security 下有“使用安全 DNS”选项。默认是 OS(default)，但是你可以更改。不仅仅是 cloudflare 的 1.1.1.1，还预设了 openDNS，以及 Google 的 8.8.8.8（public DNS）等高质量的 DNS 服务，可以自行选择。\n对于 edge，操作类似。但是可能会有神秘组策略设置导致你无法启用这个选项，需要自行解决。对于 Firefox，它有非常强大的设置选项，你可以自行搜索。\n效果 效果可能随你机子的地理位置和网络服务商的不同而不同。\n在我学校和家里实验，我的博客，以及其他 github pages 或者 cloudflare pages 的加载会大幅加速。github 主站的可访问性会提高。cloudflare workers 和 js delivr 等遭遇 DNS 污染而没有被墙的网站将能够直连访问。有时遭遇 DNS 污染而跳转到神秘 nsfw 网站的风险会消失。\n总之是件惠而不费的事情。\n副作用提醒：\n开启浏览器安全 DNS (DoH) 后，你可能会发现访问淘宝、B站或微信网页版时速度变慢了。\n这是因为使用海外 DNS (1.1.1.1) 会导致国内网站的 CDN 误判你的位置，把你调度到海外的服务器上去。\n这是一个无奈的权衡： 为了正确访问 Github 或看到数学公式，我们牺牲了一点访问国内网站的速度。如果你平时主要浏览国内网站，可以在不需要时去浏览器设置里把这个选项关掉。 这就是我们当前面临的网络现实。\n总结 充分暴露了中国网络环境的恶劣。\n以及这篇文章是用 Emacs 写的。给 Emacs 打个广告（或者我的博客）。\n","wordCount":"216","inLanguage":"en","datePublished":"2025-11-26T18:38:39+08:00","dateModified":"2025-11-26T18:38:39+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://litjohn.github.io/posts/use-better-dns/"},"publisher":{"@type":"Organization","name":"正确即是废话，废话亦是正确","logo":{"@type":"ImageObject","url":"https://litjohn.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://litjohn.github.io/ accesskey=h title="正确即是废话，废话亦是正确 (Alt + H)">正确即是废话，废话亦是正确</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://litjohn.github.io/categories/ title=分类><span>分类</span></a></li><li><a href=https://litjohn.github.io/tags/ title=标签><span>标签</span></a></li><li><a href=https://litjohn.github.io/series/ title=系列><span>系列</span></a></li><li><a href=https://litjohn.github.io/archives/ title=归档><span>归档</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">为你的设备配置更好的 DNS</h1><div class=post-meta><span title='2025-11-26 18:38:39 +0800 +0800'>November 26, 2025</span></div></header><div class=post-content><h2 id=前言>前言<a hidden class=anchor aria-hidden=true href=#前言>#</a></h2><p>昨天对<a href=https://litjohn.github.io>我的博客</a>界面进行了更新。但是你可能发现数学公式（katex）炸了。</p><p>更有趣的是，你可能会发现换了一台设备，katex 又复活了。而在某些设备上，katex 就是渲染不出来。</p><p>这正是我本人的经历：我在家里能够看到正常渲染的 katex，但是到了学校就渲染不了。</p><p>事实上，这并不是我配置写出锅了。而是 GFW 搞的鬼。</p><h2 id=排查问题>排查问题<a hidden class=anchor aria-hidden=true href=#排查问题>#</a></h2><p>我们将使用一些入门级的网络开发者工具。</p><p>使用 F12 等方法打开 chrome（或其他浏览器）的开发者工具。选择“network”项。先点击左上角的灰色禁止图标（一个被斜杠穿过的圆圈）清除过去的活动记录，然后点击它左边的灰色同心圆开启活动记录录制（如果这个图标是红色的圆圈套着方框，那么录制已经开始了，不用管。这个图标看上去和你手机录像时的那个红色源泉很像）。勾选最上方的“preserve log”（其实不勾也行）。然后如果下面有一个类似于“/get”之类的过滤选项，关掉它。</p><p>访问<a href=https://litjohn.github.io>我的博客</a>。</p><p>看下面的那一栏（上面一栏是时间轴，不用理会），它显示了访问我博客时的各种网络活动，包括名字，URL，状态等等。</p><p>我们发现大多数都正常返回（状态码 200），但是有一些会显示叉和 404 或者其他一些状态码。这些请求里有名字带 .ico 或者类似于 icon 之类的，这些是请求博客的图标（我没设置），不用管。</p><p>注意到有名字中带 katex 和 css/js 或者 auto-render 之类的（比如 katex.min.js/katex.min.css/auto-render.min.js）。这些其实就是在向 cdn 请求用于渲染 katex 公式的脚本和样式。</p><p>观察到域名大概是 cdn.jsdelivr.net。</p><p>试着使用 curl/iwr 或者浏览器直接访问。发现访问不了。</p><p>至此，我们找到了罪魁祸首。</p><h2 id=分析原因>分析原因<a hidden class=anchor aria-hidden=true href=#分析原因>#</a></h2><p>jsdelivr 是一个著名的 cdn，可以让你把你的 git 仓库弄上去，然后提供加速的下载（即内容分发）。不过这个 cdn 现在不是很稳定，有时（指有些 DNS 服务器上）会被 DNS 污染导致访问不了。</p><p>事实上，这应该是 hugo 生成器或者 papermod 主题默认的 katex 来源。所以使用这套东西的人可能会遇到和我一模一样的问题。</p><p>所幸它没有遭遇 SNI 阻断甚至 IP 黑洞之类更加强力的 GFW 手段，这使得我们可以在直连情况下解决问题。</p><h2 id=解决>解决<a hidden class=anchor aria-hidden=true href=#解决>#</a></h2><h3 id=第一步>第一步<a hidden class=anchor aria-hidden=true href=#第一步>#</a></h3><p>首先我太懒不想改自己博客的配置。那么怎么办呢？不换 cdn，就要访问原来的 cdn。</p><p>访问不了 cdn 是因为 DNS 污染。那么就从 DNS 污染上解决问题。</p><p>cloudflare 提供了非常优质的 DNS 服务（服务器 IP 1.1.1.1 或 1.0.0.1）。我们配置它作为我们的 DNS 服务器直接就搞定了。</p><p>具体而言，你可以搜索你的操作系统的具体方法。对于 Windows，打开设置项，进入“网络和 Internet > 以太网”（当然也可以是 WLAN）然后你就能看到设置 DNS 服务器的选项，编辑一下，用 1.1.1.1 作为 IPv4 DNS 就完成了。</p><p>不过这又引出了一些新的麻烦。</p><h3 id=解决与-clash-的冲突>解决与 clash 的冲突<a hidden class=anchor aria-hidden=true href=#解决与-clash-的冲突>#</a></h3><p>如果你使用代理，你有概率发现你的代理用不成了。这非常的令人费解。你会发现你连不上代理服务器（也就是说不是 clash 等客户端的问题）</p><p>怎么回事呢？</p><p>很多代理的节点是用供应商自己的一个的中转服务器访问的，通过不同的端口控制你的流量转发到不同的海外节点。这个中转服务器有自己的域名，而不仅仅是通过 IP 访问。也就是说，你的 clash 要和这个服务器通信才能将你的流量转发到真正的代理节点上，而这个通信又需要解析域名。</p><p>如果你用国内的 DNS，域名解析出来的 IP 是国内可直连的。但是 1.1.1.1 解析这个域名的策略和国内 DNS 不同，它可能会解析到中转服务器在海外的 IP。而这个 IP 是被墙掉的，你无法直连你的代理~~（你需要一个代理来访问你的代理）~~，这就导致你的代理用不成了。</p><p>怎么办？怎么办？</p><p>一种方法：编辑 hosts 文件，将你代理的中转服务器的域名绑定到可访问的 IP。或者编辑 clash 的配置文件中类似 hosts 的东西。</p><p>但是这样会面临代理换用不同域名/IP 的问题。还有更好的办法。</p><p>我们首先把 DNS 服务器改回来（比如改成 DHCP 自动分配）。然后我们敏锐的注意到一点：我们需要使用 1.1.1.1 解析的请求，大部分都是在浏览器端完成的。</p><p>所以给浏览器设置一下，让它使用 1.1.1.1 作为 DNS 就行了。</p><p>这无需额外插件，原生设置即可。对于 chrome，chrome://settings/security 下有“使用安全 DNS”选项。默认是 OS(default)，但是你可以更改。不仅仅是 cloudflare 的 1.1.1.1，还预设了 openDNS，以及 Google 的 8.8.8.8（public DNS）等高质量的 DNS 服务，可以自行选择。</p><p>对于 edge，操作类似。但是可能会有神秘组策略设置导致你无法启用这个选项，需要自行解决。对于 Firefox，它有非常强大的设置选项，你可以自行搜索。</p><h2 id=效果>效果<a hidden class=anchor aria-hidden=true href=#效果>#</a></h2><p>效果可能随你机子的地理位置和网络服务商的不同而不同。</p><p>在我学校和家里实验，我的博客，以及其他 github pages 或者 cloudflare pages 的加载会大幅加速。github 主站的可访问性会提高。cloudflare workers 和 js delivr 等遭遇 DNS 污染而没有被墙的网站将能够直连访问。有时遭遇 DNS 污染而跳转到神秘 nsfw 网站的风险会消失。</p><p>总之是件惠而不费的事情。</p><p><strong>副作用提醒：</strong></p><p>开启浏览器安全 DNS (DoH) 后，你可能会发现访问淘宝、B站或微信网页版时速度变慢了。</p><p>这是因为使用海外 DNS (1.1.1.1) 会导致国内网站的 CDN 误判你的位置，把你调度到海外的服务器上去。</p><p>这是一个无奈的权衡： 为了正确访问 Github 或看到数学公式，我们牺牲了一点访问国内网站的速度。如果你平时主要浏览国内网站，可以在不需要时去浏览器设置里把这个选项关掉。
这就是我们当前面临的网络现实。</p><h2 id=总结>总结<a hidden class=anchor aria-hidden=true href=#总结>#</a></h2><p>充分暴露了中国网络环境的恶劣。</p><p>以及这篇文章是用 Emacs 写的。给 Emacs 打个<a href=https://www.luogu.com.cn/article/v1ecwprt>广告</a>（或者<a href=https://litjohn.github.io/posts/set-up-emacs/>我的博客</a>）。</p></div><footer class=post-footer><ul class=post-tags></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://litjohn.github.io/>正确即是废话，废话亦是正确</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>